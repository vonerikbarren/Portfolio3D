<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Database Test with Table</title>
   <style>label{display: inline-block; width:80px}</style>

   <style>
   table {
         font-family: arial, sans-serif;
         border-collapse: collapse;
         width: 50%;
      }

      td, th {
         border: 1px solid #dddddd;
         text-align: center;
         padding: 8px;
      }

      tr:nth-child(even) {
         background-color: #dddddd;
      }
   </style>
</head>

<!-- Body Section -->
<body>

   <!-- Labels and Containers for Inputs -->
   <label>Title of Deck</label> <input id="DeckTitle" type="text"> <br><br>
   <label>Front Side</label> <input id="FrontSide" type="text"> <br><br>
   <label>Back Side</label> <input id="BackSide" class="SecB" type="text"> <br><br>
   <label>Card Code</label> <input id="CardCode" type="text"> <br> <br>
   <label>Date and Time</label> <input id="DateTime" type="datetime-local">
   

   <hr>

   <table>

      <!-- Header -->
      <tr>
         <th id="TableTitle">Title</th>
         <th id="TableFrontSide">Front Side</th>
         <th id="TableBackSide">Back Side</th>
         <th id="TableCardCode">Card Code</th>
         <th id="DateTime">Date and Time</th>
      </tr>

      <!-- Table: Row A -->
      <tr>
         <td id="A1"></td>
         <td id="A2"></td>
         <td id="A3"></td>
         <td id="A4"></td>
         <td id="A5"></td>
      </tr>

      <!-- Table: Row B -->
      <tr>
         <td id="B1"></td>
         <td id="B2"></td>
         <td id="B3"></td>
         <td id="B4"></td>
      </tr>

      <!-- Table: Row C -->
      <tr>
         <td id="C1"></td>
         <td id="C2"></td>
         <td id="C3"></td>
         <td id="C4"></td>
      </tr>

      <!-- Table: Row D -->
      <tr>
         <td id="D1"></td>
         <td id="D2"></td>
         <td id="D3"></td>
         <td id="D4"></td>
      </tr>

   </table>

   <br>

   <!-- Buttons for action -->
   <hr>
   <button id="Insbtn">INSERT</button>
   <button id="Selbtn">SELECT</button>
   <button id="Updbtn">UPDATE</button>
   <button id="Delbtn">DELETE</button>



   <script type="module">

      // ------------------ Configurations -------------------- // 

      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      const firebaseConfig = {
         apiKey: "AIzaSyAXGCA1w5cHCPOp90Syuvxlqnd9mMr3Ap8",
         authDomain: "formtest02-e3383.firebaseapp.com",
         databaseURL: "https://formtest02-e3383-default-rtdb.firebaseio.com",
         projectId: "formtest02-e3383",
         storageBucket: "formtest02-e3383.appspot.com",
         messagingSenderId: "222453041647",
         appId: "1:222453041647:web:e5d3a584698c96b9574e1a"
      };
      
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);

      import {getDatabase, ref, get, set, child, update, remove}
      from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js"

      const db = getDatabase()


      // ------------------ References -------------------- // 
      var deckTitle = document.getElementById("DeckTitle")
      var frontSide = document.getElementById("FrontSide")
      var backSide = document.getElementById("BackSide")
      var cardCode = document.getElementById("CardCode")
      var dateTime = document.getElementById("DateTime")


      var insBtn = document.getElementById("Insbtn")
      var selBtn = document.getElementById("Selbtn")
      var updBtn = document.getElementById("Updbtn")
      var delBtn = document.getElementById("Delbtn")

      var cell_A1 = document.getElementById("A1")
      var cell_A2 = document.getElementById("A2")
      var cell_A3 = document.getElementById("A3")
      var cell_A4 = document.getElementById("A4")

      var cellB1 = document.getElementById("B1")
      var cellB2 = document.getElementById("B2")
      var cellB3 = document.getElementById("B3")
      var cellB4 = document.getElementById("B4")


      console.log(insBtn.value)


      // ------------------ Insert Data -------------------- // 

      function InsertData(){
         set(ref(db, "TheTestDeck/" + cardCode.value), {
            TitleOfDeck: deckTitle.value,
            FrontSide: frontSide.value,
            BackSide: backSide.value,
            CardCode: cardCode.value,
            DateAndTime: dateTime.value,
         })
         .then(() => {
            alert("data stored succesffuly")
         })
         .catch((error) => {
            alert("unsuccessful, error" + error)
            console.log(Error)
         })
      }


      // ------------------ Select Data -------------------- // 

      function SelectData() {
         const dbref = ref(db)

         get(child(dbref, "TheTestDeck/" + cardCode.value)).then((snapshot) => {
            if(snapshot.exists()) {
               deckTitle.value = snapshot.val().TitleOfDeck
               frontSide.value = snapshot.val().FrontSide
               backSide.value = snapshot.val().BackSide
               dateTime.value = snapshot.val().DateAndTime
            }

            else {
               alert("No data found");
            }
         })
         .catch((error) => {
            alert("unsuccessful, error" + error)
         });
      }


      // ------------------ Update Data -------------------- // 

      function UpdateData() {
         update(ref(db, "TheTestDeck/" + cardCode.value), {
            TitleOfDeck: deckTitle.value,
            FrontSide: frontSide.value,
            BackSide: backSide.value,
            DateAndTime: dateTime.value,
         })
         .then(() => {
            alert("data updated succesffuly")
         })
         .catch((error) => {
            alert("unsuccessful, error" + error)
            console.log(Error)
         })
      }


      // ------------------ Delete Data -------------------- // 

      function DeleteData() {
         remove(ref(db, "TheTestDeck/" + cardCode.value))
         .then(() => {
            alert("data deleted succesffuly")
         })
         .catch((error) => {
            alert("unsuccessful, error" + error)
            console.log(Error)
         })
      }



      // ------------------ Assign Events to Btns -------------------- // 

      insBtn.addEventListener('click', InsertData)
      selBtn.addEventListener('click', SelectData)
      updBtn.addEventListener('click', UpdateData)
      delBtn.addEventListener('click', DeleteData)

    </script>

   
</body>
</html>